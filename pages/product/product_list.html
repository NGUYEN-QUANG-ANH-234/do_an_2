<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <title>Danh mục sản phẩm - Mina Rubber</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
    <link rel="icon" href="../../assets/img/123.ico" type="image/png" />

    <link rel="stylesheet" href="../../css/input.css" />
  </head>

  <body class="bg-slate-50 min-h-screen flex text-slate-800">
    <!-- Sidebar -->
    <aside
      class="w-64 bg-slate-900 text-slate-300 flex-shrink-0 min-h-screen"
    ></aside>

    <main class="flex-1 flex flex-col">
      <!-- Header chuẩn format -->
      <header
        class="h-16 bg-white shadow-sm flex items-center justify-between px-8 relative z-10"
      >
        <h2
          class="text-lg font-black text-slate-700 uppercase italic tracking-tighter"
        >
          Quản lý Sản phẩm
        </h2>

        <div class="flex items-center space-x-6">
          <!-- Các nút chức năng đặc thù -->
          <div class="flex items-center gap-3 border-r pr-6">
            <button
              id="btnSystemLog"
              onclick="window.location.href='product_history.html'"
              class="w-10 h-10 flex items-center justify-center hover:bg-blue-50 text-blue-600 rounded-full transition-all"
              title="Nhật ký hoạt động hệ thống"
            >
              <i class="fas fa-history"></i>
            </button>
            <button
              onclick="toggleModal('productModal')"
              class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-xl flex items-center shadow-lg transition-all font-bold text-sm"
            >
              <i class="fas fa-plus me-2"></i> Thêm sản phẩm
            </button>
          </div>

          <div id="headerUserContainer"></div>
        </div>
      </header>

      <div class="p-8">
        <!-- Bộ lọc -->
        <div
          class="bg-white p-6 rounded-3xl shadow-sm border border-slate-200 mb-6 flex flex-wrap gap-4 items-end"
        >
          <div class="flex-1 min-w-[300px]">
            <label
              class="block text-[10px] font-black text-slate-400 uppercase mb-2 ml-1 tracking-widest"
              >Tìm kiếm sản phẩm</label
            >
            <input
              type="text"
              id="searchInput"
              oninput="filterProducts()"
              placeholder="Nhập mã hoặc tên sản phẩm..."
              class="w-full px-5 py-2.5 bg-slate-50 border border-slate-200 rounded-2xl outline-none focus:ring-4 focus:ring-blue-500/10 text-sm italic"
            />
          </div>
          <div class="w-64">
            <label
              class="block text-[10px] font-black text-slate-400 uppercase mb-2 ml-1 tracking-widest"
              >Lọc theo nhóm</label
            >
            <select
              id="filterCategory"
              onchange="filterProducts()"
              class="w-full px-5 py-2.5 bg-slate-50 border border-slate-200 rounded-2xl outline-none font-bold text-sm"
            >
              <option value="">Tất cả nhóm</option>
            </select>
          </div>
        </div>

        <!-- Bảng danh sách -->
        <div
          class="bg-white shadow-sm rounded-3xl overflow-hidden border border-slate-200"
        >
          <table class="w-full text-left">
            <thead
              class="bg-slate-50/50 text-slate-400 text-[10px] uppercase font-black tracking-widest border-b"
            >
              <tr>
                <th class="px-8 py-5">Sản phẩm / Mã</th>
                <th class="px-8 py-5">Nhóm sản phẩm</th>
                <th class="px-8 py-5">Kích thước / Loại</th>
                <th class="px-8 py-5">Giá bán lẻ</th>
                <th class="px-8 py-5 text-center">Ngày hiệu lực</th>
                <th class="px-8 py-5 text-center">Trạng thái</th>
                <th class="px-8 py-5 text-right">Thao tác</th>
              </tr>
            </thead>
            <tbody
              id="productBody"
              class="divide-y divide-slate-50 text-sm font-medium"
            >
              <!-- Rendered by product_list.js -->
            </tbody>
          </table>
        </div>
      </div>
    </main>

    <!-- MODAL: THÊM/SỬA SẢN PHẨM -->
    <div
      id="productModal"
      class="fixed inset-0 bg-slate-900/60 backdrop-blur-sm hidden items-center justify-center z-[100] p-4"
    >
      <div
        class="bg-white w-full max-w-2xl rounded-3xl shadow-2xl overflow-hidden border border-white/20"
      >
        <div
          class="p-8 border-b border-slate-50 flex justify-between items-center bg-slate-50/50"
        >
          <h3
            class="text-xl font-black text-slate-800 uppercase italic"
            id="modalTitle"
          >
            Thêm sản phẩm mới
          </h3>
          <button
            onclick="toggleModal('productModal')"
            class="text-slate-400 hover:text-slate-600 transition-colors"
          >
            <i class="fas fa-times fa-lg"></i>
          </button>
        </div>

        <form id="productForm" class="p-8 grid grid-cols-2 gap-6">
          <input type="hidden" id="edit_product_id" name="product_id" />

          <div class="col-span-1">
            <label
              class="block text-[10px] font-black text-slate-400 uppercase mb-2 ml-1 tracking-widest"
              >Mã sản phẩm</label
            >
            <input
              name="product_code"
              type="text"
              required
              placeholder="Ví dụ: L-XM-001"
              class="w-full px-5 py-3 bg-slate-50 border border-slate-200 rounded-2xl outline-none focus:ring-4 focus:ring-blue-500/10 font-bold"
            />
          </div>

          <div class="col-span-1">
            <label
              class="block text-[10px] font-black text-slate-400 uppercase mb-2 ml-1 tracking-widest"
              >Nhóm sản phẩm</label
            >
            <select
              name="category_id"
              id="categorySelect"
              class="w-full px-5 py-3 bg-slate-50 border border-slate-200 rounded-2xl outline-none font-bold text-sm"
            ></select>
          </div>

          <div class="col-span-2">
            <label
              class="block text-[10px] font-black text-slate-400 uppercase mb-2 ml-1 tracking-widest"
              >Tên sản phẩm đầy đủ</label
            >
            <input
              name="product_name"
              type="text"
              required
              placeholder="Ví dụ: Lốp xe máy Mina Ultra"
              class="w-full px-5 py-3 bg-slate-50 border border-slate-200 rounded-2xl outline-none focus:ring-4 focus:ring-blue-500/10 font-bold"
            />
          </div>

          <div
            class="col-span-1 p-4 bg-orange-50/50 rounded-3xl border border-orange-100"
          >
            <label
              class="block text-[10px] font-black text-orange-400 uppercase mb-2 ml-1 tracking-widest"
              >Giá bán lẻ (VNĐ)</label
            >
            <input
              name="current_price"
              type="number"
              required
              class="w-full px-5 py-3 bg-white border border-orange-200 rounded-2xl outline-none focus:ring-4 focus:ring-orange-500/10 font-black text-orange-600"
            />
          </div>

          <div
            class="col-span-1 p-4 bg-blue-50/50 rounded-3xl border border-blue-100"
          >
            <label
              class="block text-[10px] font-black text-blue-400 uppercase mb-2 ml-1 tracking-widest"
              >Ngày hiệu lực giá</label
            >
            <input
              name="effective_date"
              type="date"
              required
              class="w-full px-5 py-3 bg-white border border-blue-200 rounded-2xl outline-none font-bold text-blue-600"
            />
          </div>

          <div class="col-span-1">
            <label
              class="block text-[10px] font-black text-slate-400 uppercase mb-2 ml-1 tracking-widest"
              >Loại lốp</label
            >
            <input
              name="tire_type"
              type="text"
              placeholder="Vd: Không săm"
              class="w-full px-5 py-3 bg-slate-50 border border-slate-200 rounded-2xl outline-none font-bold"
            />
          </div>

          <div class="col-span-1">
            <label
              class="block text-[10px] font-black text-slate-400 uppercase mb-2 ml-1 tracking-widest"
              >Kích thước</label
            >
            <input
              name="size"
              type="text"
              placeholder="Vd: 110/70-17"
              class="w-full px-5 py-3 bg-slate-50 border border-slate-200 rounded-2xl outline-none font-bold"
            />
          </div>

          <div
            class="col-span-2 mt-4 flex justify-end space-x-3 pt-6 border-t border-slate-50"
          >
            <button
              type="button"
              onclick="toggleModal('productModal')"
              class="px-8 py-3 text-slate-400 font-black uppercase text-xs hover:text-slate-600 transition-all"
            >
              Hủy bỏ
            </button>
            <button
              type="submit"
              class="px-10 py-3 bg-blue-600 text-white rounded-2xl font-black uppercase text-xs shadow-xl shadow-blue-200 hover:bg-blue-700 transition-all"
            >
              Lưu sản phẩm
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Toast Container -->
    <div
      id="toastContainer"
      class="fixed bottom-5 right-5 z-[100] space-y-3"
    ></div>

    <script src="../../js/main.js"></script>
    <script src="../../js/modules/product/product_list.js"></script>
  </body>
</html>
